server:
  grpc_port: 4443
  http_port: 80
  https_port: 443
  api_port: 4040
  domain: "grok.io"

  # TCP tunnel port allocation range
  # Allocates ports for TCP tunnels dynamically from this range
  # Each TCP tunnel gets a unique port (e.g., tcp://domain:12345)
  # Range size determines max concurrent TCP tunnels
  tcp_port_start: 10000  # Start of port range (default: 10000)
  tcp_port_end: 20000    # End of port range (default: 20000, allows 10,001 TCP tunnels)

  # SECURITY: CORS allowed origins
  # Only requests from these origins will be allowed
  # For production, specify your exact domain(s)
  allowed_origins:
    - "http://localhost:5173"   # Vite dev server
    - "http://localhost:4040"   # Dashboard API
    # - "https://dashboard.yourdomain.com"  # Production dashboard

database:
  # Driver: "sqlite" or "postgres"
  driver: "sqlite"

  # SQLite configuration (when driver is "sqlite")
  database: "grok.db"  # File path, use ":memory:" for in-memory database

  # PostgreSQL configuration (when driver is "postgres")
  # driver: "postgres"
  # host: "localhost"
  # port: 5432
  # database: "grok"
  # username: "grok"
  # password: "your-password-here"
  # ssl_mode: "disable"

# TLS Configuration
# TLS is used for:
# 1. HTTPS tunnel connections (public URLs)
# 2. gRPC connections between client and server (tunnel control)
#
# Three options:
# 1. Auto Certificate (Let's Encrypt) - Production with public domain
# 2. Manual Certificate - Production with custom CA or self-signed for dev
# 3. Disabled - Development only (insecure)
tls:
  # Option 1: Auto Certificate with Let's Encrypt (RECOMMENDED for production)
  auto_cert: false
  cert_dir: "/var/lib/grok/certs"
  email: "admin@grok.io"

  # Option 2: Manual Certificate
  # For production: Use certificates from trusted CA
  # For development: Generate self-signed certificate with: grok-server gencert
  cert_file: "certs/server.crt"
  key_file: "certs/server.key"

  # Note: If both auto_cert and cert_file/key_file are specified,
  # manual certificate takes precedence.

  # Generate self-signed certificate for development:
  #   grok-server gencert
  #   grok-server gencert --host yourdomain.com
  #   grok-server gencert --cert /path/to/server.crt --key /path/to/server.key

auth:
  # SECURITY: JWT secret for signing authentication tokens
  # REQUIRED: Must be at least 32 characters long
  # RECOMMENDED: Use environment variable instead of hardcoding
  #
  # Generate a secure secret with: openssl rand -base64 48
  # Set via environment variable: export GROK_AUTH_JWT_SECRET="your-secret-here"
  # Environment variables override this config file value
  #
  # For production: Use environment variable (see above)
  # For development: Generate new secret or use the example below
  #
  # Example generated secret (DO NOT use this in production!):
  jwt_secret: "change-this-to-a-secure-random-string-min-32-chars-long"

tunnels:
  max_per_user: 5
  idle_timeout: "10m"
  heartbeat_interval: "30s"
  # Maximum number of request logs to keep per tunnel
  # When limit is exceeded, oldest requests are automatically deleted
  # This prevents unbounded database growth while keeping recent history
  max_request_logs: 1000

webhooks:
  # Maximum number of webhook events to keep per app
  # When limit is exceeded, oldest events are automatically deleted
  # This prevents unbounded database growth while keeping recent history
  max_events: 500

logging:
  level: "info"      # debug, info, warn, error
  format: "json"     # json, text
  output: "stdout"   # stdout, file
  # file: "/var/log/grok/server.log"
  sql_log_level: "silent"  # GORM SQL query logging: silent (default, no logs), error, warn, info (all queries)
